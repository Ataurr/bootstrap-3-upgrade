{"ts":1375983180817,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1375983345019,"patch":[[{"diffs":[[1,"var port = process.env.PORT || 4000,\r\n    app = require('./app').init(port),\r\n    conf = require('./conf'),\r\n    request = require('request');\r\n    \r\n/* default route */\r\napp.get('/', function(req,res){\r\n    \r\n    var urlToFetch = req.query[\"url\"],\r\n        apiKey = req.query[\"apiKey\"],\r\n        h = req.query.h,\r\n        w = req.query.w,\r\n        d = req.query.d,\r\n        q = req.query.q,\r\n        namedResolution = req.query.size,\r\n        wxh = req.query.wxh,\r\n        fresh = req.query.fresh||false;\r\n\r\n    if (!urlToFetch) {\r\n        console.log(\"show home page\");\r\n        res.render(\"index\");\r\n    }\r\n    else {\r\n        \r\n        \r\n    }\r\n});\r\n\r\napp.get('/preview', function(req, res){\r\n    res.render('preview');\r\n});\r\n\r\napp.get('/api', function(req, res){\r\n    res.render('api');\r\n});\r\n\r\napp.get('/proxy', function(req, res){\r\n    if (req.param(\"purl\")) {\r\n        request(unescape(req.param(\"purl\")), function (error, response, body) {\r\n\t\t\tif (!error && response.statusCode == 200) {\r\n\t\t\t\tres.send(body);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tres.json({error:\"Bad URL request.\"});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n    else {\r\n        res.json({error:\"URL is required.\"});\r\n    }\r\n});\r\n\r\n/* The 404 Route (ALWAYS Keep this as the last route) */\r\napp.get('/*', function(req, res){\r\n    res.render('404.ejs');\r\n});\r\n\r\n"]],"start1":0,"start2":0,"length1":0,"length2":1297}]],"length":1297,"saved":false}
{"ts":1375983380876,"patch":[[{"diffs":[[0,"],\r\n"],[-1,"        apiKey = req.query[\"apiKey\"],\r\n        h = req.query.h,\r\n        w = req.query.w,\r\n        d = req.query.d,\r\n        q = req.query.q,\r\n        namedResolution = req.query.size,\r\n        wxh = req.query.wxh,\r\n"],[0,"    "]],"start1":246,"start2":246,"length1":224,"length2":8}]],"length":1081,"saved":false}
{"ts":1375983664146,"patch":[[{"diffs":[[0,"'404.ejs');\r\n});\r\n\r\n"],[1,"var convert = function(str){\r\n    \r\n        \r\n    \r\n}\r\n\r\n\r\n"]],"start1":1061,"start2":1061,"length1":20,"length2":79}]],"length":1140,"saved":false}
{"ts":1375983717986,"patch":[[{"diffs":[[0,"(str){\r\n"],[1,"\r\n"],[0,"    "],[-1,"\r\n        "],[1,"str = str.replace(/container-fluid/g,\"container\");\r\n    str = str.replace(/row-fluid/g,\"row\");\r\n    //str = str.replace(/span(?=[1-9|10|11|12])/g,'col col-lg-');\r\n    str = str.replace(/span(?=[1-9|10|11|12])/g,'col-lg-');\r\n    str = str.replace(/offset(?=[1-9|10|11|12])/g,'col-offset-');\r\n    str = str.replace(/(?!class=\\\")btn(?=[\\s\\\"][^\\-|btn])/g,'btn btn-default');\r\n    str = str.replace(/btn-mini/g,'btn-small');\r\n    str = str.replace(/hero-unit/g,'jumbotron');\r\n    str = str.replace(/nav-list/g,'');\r\n    str = str.replace(/nav-fixed-sidebar/g,'affix');\r\n    //str = str.replace(/(?!class=\\\")icon/g,'glyphicon');\r\n    //str = str.replace(/[^glyph]icon-(?=[a-zA-Z]+)/g,'glyphicon glyphicon-');\r\n    //str = str.replace(/icon-(?=[a-zA-Z]+)/g,'glyphicon glyphicon-');   \r\n    //str = str.replace(/(?!class=\\\")icon(?=[\\s\\\"]?[^icon])/g,'glyphicon glyphicon'); works!\r\n    //str = str.replace(/[^glyph]icon-(?=[a-zA-Z])/g,'glyphicon glyphicon-');\r\n    \r\n    str = str.replace(/(='\\bicon-)/g,\"='glyphicon glyphicon-\");\r\n    str = str.replace(/(=\"\\bicon-)/g,\"=\\\"glyphicon glyphicon-\");\r\n    str = str.replace(/(=\\bicon-)/g,\"=glyphicon glyphicon-\");\r\n    str = str.replace(/\\bclass+(\\sicon-)/g,\"=\\\"glyphicon glyphicon-\");\r\n    \r\n    str = str.replace(/(?!class=\\\")brand/g,'navbar-brand');\r\n    str = str.replace(/(?!class=\\\")btn btn-navbar/g,'navbar-toggle');\r\n    str = str.replace(/(?!class=\\\")-phone/g,'-sm');\r\n    str = str.replace(/(?!class=\\\")-tablet/g,'-md');\r\n    str = str.replace(/(?!class=\\\")-desktop/g,'-lg');\r\n    \r\n    $('#ele').remove();\r\n    var ele = $('<section id=\"ele\" style=\"display:none;\"></section>');\r\n    ele.html(str);\r\n    ele.appendTo('body');\r\n    \r\n    //navbar\r\n    var nb = $('#ele').find('.navbar');\r\n    if (typeof nb!=\"undefined\"){\r\n        nb.find('.nav').addClass('navbar-nav'); // add the navbar-nav class\r\n        nb.find('.btn').addClass('navbar-btn');\r\n        var nb_inner = nb.find('.navbar-inner'); // remove the 2.x navbar-inner\r\n        var h = nb_inner.html();\r\n        if (typeof h!=\"undefined\"){\r\n            nb.html(h);\r\n        }\r\n    }\r\n    \r\n    //icons\r\n    var icos = $('#ele').find(\"[class^=icon]\");\r\n    \r\n    //imgs\r\n    var imgs = $('#ele img').addClass(\"img-responsive\");\r\n    \r\n    // replace .thumbnails with .media-list\r\n            \r\n    return $('#ele').html();"],[0,"\r\n    \r\n"]],"start1":1103,"start2":1103,"length1":30,"length2":2349}]],"length":3459,"saved":false}
{"ts":1375983760766,"patch":[[{"diffs":[[0,"),\r\n"],[-1,"    conf = require('./conf'),\r\n"],[0,"    "]],"start1":74,"start2":74,"length1":39,"length2":8}]],"length":3428,"saved":false}
{"ts":1375983840101,"patch":[[{"diffs":[[0,"g');\r\n    \r\n"],[1,"    \r\n    /*\r\n"],[0,"    $('#ele'"]],"start1":2604,"start2":2604,"length1":24,"length2":38},{"diffs":[[0,");\r\n    "],[1,"*/\r\n    \r\n    return str;"],[0,"\r\n}\r\n\r\n\r"]],"start1":3425,"start2":3425,"length1":16,"length2":41}]],"length":3467,"saved":false}
{"ts":1375983867015,"patch":[[{"diffs":[[0,"\r\n    }\r\n});\r\n\r\n"],[1,"app.post('/', function(req, res){\r\n    \r\n    \r\n    \r\n    \r\n});\r\n\r\n"],[0,"app.get('/previe"]],"start1":393,"start2":393,"length1":32,"length2":98}]],"length":3533,"saved":false}
{"ts":1375984000822,"patch":[[{"diffs":[[0,"    "],[-1,"\r\n    \r\n    \r\n});\r\n\r\napp.get('/preview', function(req, res){\r\n    res.render('preview');"],[1,"var source = req.body[\"source\"];\r\n    var target = convert(source);\r\n    res.json({result:target});\r\n"],[0,"\r\n})"]],"start1":450,"start2":450,"length1":96,"length2":109},{"diffs":[[0,"p.get('/"],[-1,"api"],[1,"preview"],[0,"', funct"]],"start1":566,"start2":566,"length1":19,"length2":23},{"diffs":[[0,"er('"],[-1,"api"],[1,"preview"],[0,"');\r"]],"start1":617,"start2":617,"length1":11,"length2":15}]],"length":3554,"saved":false}
